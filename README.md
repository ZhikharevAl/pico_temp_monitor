# Pico W Monitoring System

–°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –¥–ª—è Raspberry Pi Pico W —Å –ø–æ–ª–Ω—ã–º —Å—Ç–µ–∫–æ–º observability: MQTT ‚Üí Prometheus ‚Üí Grafana.

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏](#–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
- [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
- [–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ](#–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ)
- [–†–∞–±–æ—Ç–∞ —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏](#—Ä–∞–±–æ—Ç–∞-—Å-–º–µ—Ç—Ä–∏–∫–∞–º–∏)
- [Grafana](#grafana)
- [Troubleshooting](#troubleshooting)
- [–ü–∞–Ω–µ–ª–∏ –¥–∞—à–±–æ—Ä–¥–∞](#–ø–∞–Ω–µ–ª–∏-–¥–∞—à–±–æ—Ä–¥–∞)
- [–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫](#–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è-–º–µ—Ç—Ä–∏–∫)
- [–ù–∞—Å—Ç—Ä–æ–π–∫–∞](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞)
- [–ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏](#–ø–æ–ª–µ–∑–Ω—ã–µ-—Å—Å—ã–ª–∫–∏)

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ **Real-time –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥
- ‚úÖ **28 –º–µ—Ç—Ä–∏–∫** - CPU, –ø–∞–º—è—Ç—å, WiFi, –±–∞—Ç–∞—Ä–µ—è, –∑–¥–æ—Ä–æ–≤—å–µ —Å–∏—Å—Ç–µ–º—ã
- ‚úÖ **–ö—Ä–∞—Å–∏–≤—ã–π –¥–∞—à–±–æ—Ä–¥** - Grafana —Å 15+ –ø–∞–Ω–µ–ª—è–º–∏
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã** - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏ –¥–∞—à–±–æ—Ä–¥—ã
- ‚úÖ **Resource limits** - –∫–æ–Ω—Ç—Ä–æ–ª—å CPU –∏ –ø–∞–º—è—Ç–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

### –°–æ–±–∏—Ä–∞–µ–º—ã–µ –º–µ—Ç—Ä–∏–∫–∏

- üå°Ô∏è –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ CPU (—Ç–µ–∫—É—â–∞—è –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è)
- üíæ –ü–∞–º—è—Ç—å (free/used/total/fragmentation)
- üì∂ WiFi (RSSI, –∫–∞—á–µ—Å—Ç–≤–æ %, –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è, –∫–∞–Ω–∞–ª)
- üîã –ë–∞—Ç–∞—Ä–µ—è (%, –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ, –∏—Å—Ç–æ—á–Ω–∏–∫ –ø–∏—Ç–∞–Ω–∏—è)
- ‚ö° CPU (—á–∞—Å—Ç–æ—Ç–∞, —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã)
- üîÑ Garbage Collector (–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å, –≤—Ä–µ–º—è)
- üìä MQTT (—É—Å–ø–µ—Ö/–æ—à–∏–±–∫–∏, success rate)
- üíö Health Score (–æ–±—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ 0-100)

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```text
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Pico W     ‚îÇ MQTT
‚îÇ  MicroPython‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ pico_metrics
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                           ‚îÇ
                           ‚ñº
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ  Mosquitto   ‚îÇ :1884
                    ‚îÇ  MQTT Broker ‚îÇ
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                           ‚îÇ
                           ‚ñº
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ MQTT Exporter‚îÇ :9000
                    ‚îÇ              ‚îÇ /metrics
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                           ‚îÇ
                           ‚ñº
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ Prometheus   ‚îÇ :9090
                    ‚îÇ TSDB         ‚îÇ
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                           ‚îÇ
                           ‚ñº
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ   Grafana    ‚îÇ :3000
                    ‚îÇ  Dashboards  ‚îÇ
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Docker Desktop –¥–ª—è Windows
- Git (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

**1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞:**

```
pico-monitoring/
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ mosquitto/
‚îÇ   ‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ mosquitto.conf
‚îÇ   ‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îî‚îÄ‚îÄ log/
‚îú‚îÄ‚îÄ prometheus/
‚îÇ   ‚îî‚îÄ‚îÄ prometheus.yml
‚îî‚îÄ‚îÄ grafana/
    ‚îî‚îÄ‚îÄ provisioning/
```

**2. –°–æ–∑–¥–∞–π—Ç–µ `mosquitto/config/mosquitto.conf`:**

```yaml
listener 1883
allow_anonymous true
persistence true
persistence_location /mosquitto/data/
log_dest file /mosquitto/log/mosquitto.log
```

**3. –°–æ–∑–¥–∞–π—Ç–µ `prometheus/prometheus.yml`:**

```yaml
global:
  scrape_interval: 15s
  evaluation_interval: 15s

scrape_configs:
  - job_name: 'mqtt-exporter'
    static_configs:
      - targets: ['mqtt-exporter:9000']
```

**4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Pico W (`config.py`):**

```python
WIFI_SSID = "YourWiFi"
WIFI_PASSWORD = "password"
MQTT_SERVER = "192.168.1.51"  # IP –≤–∞—à–µ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞
MQTT_PORT = 1883
MQTT_TOPIC = b"pico_metrics"
PUBLISH_INTERVAL = 10
```

**5. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∏—Å—Ç–µ–º—É:**

```cmd
cd pico-monitoring
docker-compose up -d
```

**6. –ü–æ–¥–æ–∂–¥–∏—Ç–µ 1-2 –º–∏–Ω—É—Ç—ã –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏**

**7. –û—Ç–∫—Ä–æ–π—Ç–µ Grafana –∏ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –¥–∞—à–±–æ—Ä–¥:**

- <http://localhost:3000> (admin/admin)
- "+" ‚Üí Import dashboard
- –í—Å—Ç–∞–≤—å—Ç–µ JSON –¥–∞—à–±–æ—Ä–¥–∞
- Import

### –î–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–∏—Å–∞–º

| –°–µ—Ä–≤–∏—Å | URL | –õ–æ–≥–∏–Ω |
|--------|-----|-------|
| üìä Grafana | <http://localhost:3000> | admin/admin |
| üìà Prometheus | <http://localhost:9090> | - |
| üì° MQTT Exporter | <http://localhost:9000/metrics> | - |
| ü¶ü Mosquitto | mqtt://localhost:1884 | - |

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã Docker Compose

```cmd
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
docker-compose up -d

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
docker-compose down

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã
docker-compose restart

# –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å
docker-compose ps

# –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –ª–æ–≥–∏
docker-compose logs -f

# –õ–æ–≥–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
docker-compose logs -f grafana
docker-compose logs -f prometheus
docker-compose logs -f mqtt-exporter
docker-compose logs -f mosquitto

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ —É–¥–∞–ª–∏—Ç—å –≤—Å—ë (–≤–∫–ª—é—á–∞—è –¥–∞–Ω–Ω—ã–µ)
docker-compose down -v
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤:**

```cmd
docker ps
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤:**

```cmd
docker stats --no-stream
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Ç—Ä–∏–∫ –æ—Ç Pico:**

```cmd
# –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ MQTT —Ç–æ–ø–∏–∫ (—Ç—Ä–µ–±—É–µ—Ç mosquitto-clients)
mosquitto_sub -h localhost -p 1884 -t "pico_metrics" -v

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –≤ exporter
curl http://localhost:9000/metrics | findstr mqtt_temperature
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ Prometheus:**

```cmd
# –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:9090
# –í Query –≤–≤–µ–¥–∏—Ç–µ: mqtt_temperature_celsius{topic="pico_metrics"}
```

### –†–∞–±–æ—Ç–∞ —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏

**–°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫:**

```cmd
curl http://localhost:9000/metrics
```

**–î–æ–ª–∂–Ω—ã –±—ã—Ç—å –º–µ—Ç—Ä–∏–∫–∏:**

- `mqtt_temperature_celsius` - –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ CPU
- `mqtt_memory_usage_percent` - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ %
- `mqtt_memory_free_bytes` - –°–≤–æ–±–æ–¥–Ω–∞—è –ø–∞–º—è—Ç—å
- `mqtt_memory_allocated_bytes` - –ó–∞–Ω—è—Ç–∞—è –ø–∞–º—è—Ç—å
- `mqtt_memory_total_bytes` - –í—Å–µ–≥–æ –ø–∞–º—è—Ç–∏
- `mqtt_memory_fragmentation` - –§—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—è –ø–∞–º—è—Ç–∏ %
- `mqtt_wifi_rssi_dbm` - –°–∏–≥–Ω–∞–ª WiFi –≤ dBm
- `mqtt_wifi_signal_quality_percent` - –ö–∞—á–µ—Å—Ç–≤–æ WiFi %
- `mqtt_wifi_connected` - –°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (0/1)
- `mqtt_wifi_reconnect_count` - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
- `mqtt_wifi_channel` - –ö–∞–Ω–∞–ª WiFi
- `mqtt_cpu_frequency_hz` - –ß–∞—Å—Ç–æ—Ç–∞ CPU
- `mqtt_uptime_seconds` - –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã
- `mqtt_battery_percent` - –£—Ä–æ–≤–µ–Ω—å –±–∞—Ç–∞—Ä–µ–∏ %
- `mqtt_vsys_voltage` - –ù–∞–ø—Ä—è–∂–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
- `mqtt_error_count` - –°—á—ë—Ç—á–∏–∫ –æ—à–∏–±–æ–∫
- `mqtt_gc_collections_total` - –°–±–æ—Ä–∫–∏ –º—É—Å–æ—Ä–∞
- `mqtt_mqtt_publish_success_total` - –£—Å–ø–µ—à–Ω—ã–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
- `mqtt_mqtt_publish_failed_total` - –ù–µ—É–¥–∞—á–Ω—ã–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
- `mqtt_mqtt_publish_success_rate` - –ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—Ö–∞
- `mqtt_health_score` - –û—Ü–µ–Ω–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è (0-100)
- `mqtt_health_issues_count` - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–±–ª–µ–º
- `mqtt_cpu_temp_max_celsius` - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞

## Grafana

![](./attachment/Grafana-1.png)
![](./attachment/Grafana-2.png)

## Troubleshooting

### –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –Ω–µ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è

```cmd
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
docker-compose ps

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
docker-compose logs

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø–æ—Ä—Ç—ã —Å–≤–æ–±–æ–¥–Ω—ã
netstat -an | findstr "3000 9090 9000 1884"
```

### –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ—Ç Pico

**1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Pico:**

```cmd
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ IP –∞–¥—Ä–µ—Å –∫–æ–º–ø—å—é—Ç–µ—Ä–∞
ipconfig

# –í config.py –Ω–∞ Pico –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π IP
MQTT_SERVER = "192.168.1.51"  # –≤–∞—à IP
```

**2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ MQTT —Ä–∞–±–æ—Ç–∞–µ—Ç:**

```cmd
# –ü–æ–¥–ø–∏—à–∏—Ç–µ—Å—å –Ω–∞ —Ç–æ–ø–∏–∫
mosquitto_sub -h localhost -p 1884 -t "pico_metrics" -v

# –î–æ–ª–∂–Ω—ã –ø–æ—è–≤–ª—è—Ç—å—Å—è JSON —Å–æ–æ–±—â–µ–Ω–∏—è –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
```

**3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ firewall Windows:**

```text
–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è ‚Üí –ë—Ä–∞–Ω–¥–º–∞—É—ç—Ä Windows ‚Üí 
–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã ‚Üí –ü—Ä–∞–≤–∏–ª–∞ –¥–ª—è –≤—Ö–æ–¥—è—â–∏—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π ‚Üí
–°–æ–∑–¥–∞—Ç—å –ø—Ä–∞–≤–∏–ª–æ ‚Üí –ü–æ—Ä—Ç ‚Üí TCP ‚Üí 1883, 1884
```

**4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:**

```cmd
docker logs mosquitto --tail 50
docker logs mqtt-exporter --tail 50
```

### –ú–µ—Ç—Ä–∏–∫–∏ –Ω–µ –ø–æ—è–≤–ª—è—é—Ç—Å—è –≤ Grafana

**1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ MQTT Exporter:**

```cmd
curl http://localhost:9000/metrics
```

–ï—Å–ª–∏ –º–µ—Ç—Ä–∏–∫ –Ω–µ—Ç - Pico –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ.

**2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Prometheus:**

```cmd
# –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:9090/targets
# mqtt-exporter –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å UP
```

**3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Data Source –≤ Grafana:**

```text
Settings ‚Üí Data Sources ‚Üí Prometheus ‚Üí Test
–î–æ–ª–∂–Ω–æ –±—ã—Ç—å: "Data source is working"
```

**4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–ø–∏–∫ –≤ Query:**

```text
–î–æ–ª–∂–Ω–æ –±—ã—Ç—å: topic="pico_metrics"
–ù–ï: topic="pico/metrics"  (–ë–ï–ó —Å–ª–µ—à–∞!)
```

### Grafana –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "No data"

**–ü—Ä–∏—á–∏–Ω—ã:**

1. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–æ–ø–∏–∫ –≤ query (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `pico_metrics`)
2. Prometheus –Ω–µ —Å–æ–±–∏—Ä–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ
3. –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ—Ç Pico
4. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—Ä–µ–º–µ–Ω–Ω–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω (–ø–æ–ø—Ä–æ–±—É–π—Ç–µ Last 5 minutes)

**–†–µ—à–µ–Ω–∏–µ:**

```cmd
# 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –µ—Å—Ç—å –≤ Prometheus
# http://localhost:9090 ‚Üí Query: mqtt_temperature_celsius

# 2. –í Grafana –ø–∞–Ω–µ–ª–∏ —É–±–µ–¥–∏—Ç–µ—Å—å:
# - Data source: Prometheus
# - Query: mqtt_temperature_celsius{topic="pico_metrics"}
# - Time range: Last 5 minutes
```

### Docker Desktop –ø—Ä–æ–±–ª–µ–º—ã

**–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —á–∞—Å—Ç–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è:**

```yaml
Docker Desktop Settings ‚Üí Resources ‚Üí 
Memory: –º–∏–Ω–∏–º—É–º 4GB
CPUs: –º–∏–Ω–∏–º—É–º 2
```

**WSL2 –ø—Ä–æ–±–ª–µ–º—ã:**

```cmd
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–µ—Ä—Å–∏—é WSL
wsl --list --verbose

# –û–±–Ω–æ–≤–∏—Ç–µ WSL
wsl --update
```

## –ü–∞–Ω–µ–ª–∏ –¥–∞—à–±–æ—Ä–¥–∞

### –í–µ—Ä—Ö–Ω—è—è —Å—Ç—Ä–æ–∫–∞ (—Å—Ç–∞—Ç—É—Å)

- **NETWORK STATUS** - –ü–æ–¥–∫–ª—é—á–µ–Ω/–û—Ç–∫–ª—é—á–µ–Ω
- **SYSTEM UPTIME** - –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã
- **HEALTH SCORE** - –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è (0-100)
- **ERROR COUNT** - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫
- **MQTT SUCCESS RATE** - –ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—à–Ω—ã—Ö –ø—É–±–ª–∏–∫–∞—Ü–∏–π

### –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ (gauges)

- **CPU TEMPERATURE** - –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ (0-80¬∞C)
- **MEMORY UTILIZATION** - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ (0-100%)
- **BATTERY** - –£—Ä–æ–≤–µ–Ω—å –∑–∞—Ä—è–¥–∞ (–µ—Å–ª–∏ –Ω–∞ –±–∞—Ç–∞—Ä–µ–µ)

### –î–µ—Ç–∞–ª–∏ –ø–∞–º—è—Ç–∏

- **MEMORY CAPACITY** - –í—Å–µ–≥–æ –ø–∞–º—è—Ç–∏
- **AVAILABLE MEMORY** - –°–≤–æ–±–æ–¥–Ω–∞—è –ø–∞–º—è—Ç—å
- **ALLOCATED MEMORY** - –ó–∞–Ω—è—Ç–∞—è –ø–∞–º—è—Ç—å

### WiFi –º–µ—Ç—Ä–∏–∫–∏

- **WIRELESS SIGNAL QUALITY** - –ö–∞—á–µ—Å—Ç–≤–æ —Å–∏–≥–Ω–∞–ª–∞ (0-100%)
- **WIFI RECONNECTS** - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
- **SIGNAL STRENGTH** - –°–∏–ª–∞ —Å–∏–≥–Ω–∞–ª–∞ (dBm)

### –ì—Ä–∞—Ñ–∏–∫–∏ (timeseries)

- **THERMAL MONITORING** - –ì—Ä–∞—Ñ–∏–∫ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã
- **FREE MEMORY TREND** - –¢—Ä–µ–Ω–¥ —Å–≤–æ–±–æ–¥–Ω–æ–π –ø–∞–º—è—Ç–∏
- **ALLOCATED MEMORY TREND** - –¢—Ä–µ–Ω–¥ –∑–∞–Ω—è—Ç–æ–π –ø–∞–º—è—Ç–∏
- **NETWORK SIGNAL ANALYSIS** - –ê–Ω–∞–ª–∏–∑ —Å–∏–≥–Ω–∞–ª–∞ WiFi
- **MQTT PUBLISH STATISTICS** - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–π
- **MEMORY FRAGMENTATION** - –§—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—è –ø–∞–º—è—Ç–∏
- **GARBAGE COLLECTOR ACTIVITY** - –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å GC

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏

- **MAX TEMPERATURE** - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ —Å –∑–∞–ø—É—Å–∫–∞
- **WIFI CHANNEL** - –ö–∞–Ω–∞–ª WiFi
- **SYSTEM VOLTAGE** - –ù–∞–ø—Ä—è–∂–µ–Ω–∏–µ Vsys
- **HEALTH ISSUES** - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–±–ª–µ–º

## –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫

### CPU Temperature

- üü¢ **< 40¬∞C** - –û—Ç–ª–∏—á–Ω–æ
- üü° **40-60¬∞C** - –ù–æ—Ä–º–∞
- üü† **60-70¬∞C** - –í—ã—Å–æ–∫–∞—è
- üî¥ **> 70¬∞C** - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è

### Memory Usage

- üü¢ **< 60%** - –•–æ—Ä–æ—à–æ
- üü° **60-80%** - –ù–æ—Ä–º–∞
- üü† **80-90%** - –í—ã—Å–æ–∫–æ–µ
- üî¥ **> 90%** - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ

### WiFi Signal Quality

- üü¢ **> 80%** - –û—Ç–ª–∏—á–Ω—ã–π
- üü° **60-80%** - –•–æ—Ä–æ—à–∏–π
- üü† **40-60%** - –£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω—ã–π
- üî¥ **< 40%** - –ü–ª–æ—Ö–æ–π

### Health Score

- üü¢ **90-100** - –û—Ç–ª–∏—á–Ω–æ
- üü° **75-90** - –•–æ—Ä–æ—à–æ
- üü† **50-75** - –ï—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã
- üî¥ **< 50** - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

### Garbage Collector Activity

- üü¢ **0-10 c/m** - –û—Ç–ª–∏—á–Ω–æ (–º–∞–ª–æ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏–∏)
- üü° **10-30 c/m** - –ù–æ—Ä–º–∞
- üî¥ **> 30 c/m** - –í–æ–∑–º–æ–∂–Ω–∞ —É—Ç–µ—á–∫–∞ –ø–∞–º—è—Ç–∏

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

**–ù–∞ Pico W (config.py):**

```python
PUBLISH_INTERVAL = 10  # —Å–µ–∫—É–Ω–¥ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
# –£–≤–µ–ª–∏—á—å—Ç–µ –¥–æ 30 –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ —ç–Ω–µ—Ä–≥–∏–∏
# –£–º–µ–Ω—å—à–∏—Ç–µ –¥–æ 5 –¥–ª—è –±–æ–ª–µ–µ —á–∞—Å—Ç–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
```

**–í Prometheus (prometheus.yml):**

```yaml
global:
  scrape_interval: 15s  # –∫–∞–∫ —á–∞—Å—Ç–æ Prometheus —Å–æ–±–∏—Ä–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ
```

### Retention (—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö)

**–í docker-compose.yml –¥–ª—è Prometheus:**

```yaml
command:
  - "--storage.tsdb.retention.time=30d"  # —Ö—Ä–∞–Ω–∏—Ç—å 30 –¥–Ω–µ–π
  - "--storage.tsdb.retention.size=10GB" # –∏–ª–∏ –¥–æ 10GB
```

–ú–µ–Ω—å—à–µ retention = –º–µ–Ω—å—à–µ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ.

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤

**–í docker-compose.yml:**

```yaml
ports:
  - "3000:3000"   # Grafana
  - "9090:9090"   # Prometheus
  - "9000:9000"   # MQTT Exporter
  - "1884:1883"   # Mosquitto
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

**–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–ª–µ—Ä—Ç—ã –≤ Grafana:**

- –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ > 70¬∞C
- –ü–∞–º—è—Ç—å > 90%
- WiFi —Å–∏–≥–Ω–∞–ª < 40%
- Error count > 5
- MQTT success rate < 95%

### –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [Grafana Documentation](https://grafana.com/docs/)
- [Prometheus Documentation](https://prometheus.io/docs/)
- [Eclipse Mosquitto](https://mosquitto.org/documentation/)
- [Docker Compose](https://docs.docker.com/compose/)

### –°–±–æ—Ä –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

```cmd
# –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –≤ —Ñ–∞–π–ª diagnostic.txt:
docker-compose ps > diagnostic.txt
docker-compose logs >> diagnostic.txt
curl http://localhost:9000/metrics >> diagnostic.txt
```
